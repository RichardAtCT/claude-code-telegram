services:
  bot:
    build: .
    # Or pull a tagged release from GHCR:
    # image: ghcr.io/richardatkinson/claude-code-telegram:1.2.0
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      # Persist SQLite database across restarts
      - bot-data:/home/botuser/workspace
      # Mount host project directory so Claude Code can read/write files
      - ${HOST_PROJECT_DIR:-.}:/home/botuser/workspace/project
      # Pass host Claude CLI credentials into the container (read-only)
      # Only needed when using CLI auth (USE_SDK=true without ANTHROPIC_API_KEY)
      # Override with CLAUDE_CONFIG_DIR env var if credentials live elsewhere
      - ${CLAUDE_CONFIG_DIR:-${HOME}/.claude}:/host-claude-config:ro

volumes:
  bot-data:
